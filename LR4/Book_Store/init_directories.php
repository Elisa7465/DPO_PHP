<?php

// Базовая директория, где будут храниться публичные файлы (например, загруженные книги и обложки)
$baseDir = __DIR__ . '/src/public';

// Список директорий, которые нужно создать
$uploadDirs = [
    $baseDir . '/uploads',         // Главная папка для загрузок
    $baseDir . '/uploads/books',   // Папка для файлов книг
    $baseDir . '/uploads/covers'   // Папка для обложек книг
];

// Проходим по каждой директории из списка
foreach ($uploadDirs as $dir) {
    // Если директория не существует, пытаемся её создать с правами 0777 (чтобы был полный доступ)
    if (!file_exists($dir)) {
        if (!@mkdir($dir, 0777, true)) { // @ подавляет предупреждения, true — создаёт вложенные папки
            echo "Ошибка создания директории: {$dir}\n"; // Сообщаем об ошибке создания
            continue; // Переходим к следующей директории
        }
    }
    // Пытаемся установить права 0777 (чтение, запись, выполнение для всех)
    if (!@chmod($dir, 0777)) {
        echo "Ошибка установки прав для директории: {$dir}\n"; // Сообщаем, если права не установились
    }
}

echo "Директории успешно созданы\n"; // Выводим сообщение об успешном выполнении
